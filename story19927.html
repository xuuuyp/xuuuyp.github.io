<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>RC4çš„Matlabå®ç°</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="story19925.html" class="logo">RC4çš„Matlabå®ç°</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">æ¦‚è§ˆ</a></li>
							<li class="active"><a href="story19927.html">è¯¦ç»†</a></li>
							<li><a href="elements.html">è§„èŒƒ</a></li>
						</ul>
						<ul class="icons">
							<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="https://github.com/pppppx" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<span class="date">September 25, 2019</span>
									<h1>è®°å½•æˆ‘çš„<br />
									RC4çš„Matlabå®ç°</a></h1>
									<p>å¦‚ä½•ä½¿ç”¨Matlabå®ç°RC4åŠ è§£å¯†<br />
									</p>
								</header>
								<p>å¯†ç å­¦è¦æ±‚å†™RC4çš„ä»£ç ï¼Œç„¶åæˆ‘ç”¨äº†Matlabï¼Œç»“æœè¢«è­¦å‘Šä¸‹æ¬¡ä¸èƒ½ç”¨Matlabäº†ï¼Œå“­å‡ºå£°ï¼Œç™½å­¦ç³»åˆ—ã€‚<br />
								ä¸»è¦åˆ†æˆå››ä¸ªå‡½æ•°ï¼Œksaï¼Œprgaï¼ŒåŠ å¯†å’Œè§£å¯†å‡½æ•°ï¼Œåˆ†åˆ«å®ç°sç›’çš„æ‰“ä¹±ï¼Œå¯†é’¥æµçš„ç”Ÿæˆä»¥åŠéå¸¸æ˜æ˜¾åŠ è§£å¯†æ“ä½œã€‚<br />
								é¦–å…ˆï¼Œæ˜¯æœ€æ—©çš„ksaç®—æ³•ã€‚sä¸€å¼€å§‹æ˜¯0-255çš„è¿ç»­æ•´æ•°ï¼Œç„¶åé€šè¿‡è½¬åŒ–ä¸ºæ•´æ•°çš„å¯†é’¥æ‰“ç®—sä¸­æ•°å€¼çš„ä½ç½®ã€‚<br />
								å…·ä½“ä»£ç çœ‹ä¸‹é¢ï¼š</p>
								<pre><code class="html">%ksaç®—æ³•
%å¯†é’¥è°ƒåº¦ç®—æ³•å‡½æ•°ï¼Œæ‰“ä¹±Sç›’çš„åˆå§‹æ’åˆ—
function s=ksa(key)
%å°†å¯†é’¥è½¬åŒ–ä¸ºæ•´æ•°
key = char(key);
K = uint16(key);
%è·å–å¯†é’¥çš„é•¿åº¦
key_length=length(key);
%åˆå§‹åŒ–sç›’
s = 0:255;
j = 0;
for i=0:1:255
	%+1å› ä¸ºæ•°ç»„ç´¢å¼•ä»1å¼€å§‹ï¼Œä¸‹åŒ
	j = mod(j + s(i+1) + K(mod(i, key_length) + 1),256);
	%swap
	s([i+1 j+1]) = s([j+1 i+1]);
end</code></pre>
								<p>é€šè¿‡ksaç®—æ³•æ±‚å‡ºçš„sç›’ï¼Œä½¿ç”¨prgaç®—æ³•æ±‚å‡ºå¯†é’¥æµã€‚å¯†é’¥æµé•¿åº¦å’Œæ˜æ–‡é•¿åº¦ä¸€è‡´ï¼Œä¸‹é¢æœ‰å¼ å›¾å°±å¾ˆç›´è§‚ï¼š</p>
								<a class="image main"><img src="images/story19927/prga.png" alt="" /></a>
								<pre><code class="html">%prgaç®—æ³•
%ä¼ªéšæœºç”Ÿæˆç®—æ³•å‡½æ•°
function key = prga(s,n)
%n æ˜æ–‡é•¿åº¦
key = uint16([]);
i = 0;j = 0;
for k=1:n
	i = mod(i + 1,256);
	j = mod(j + s(i+1),256);
	%swap
	s([i+1 j+1]) = s([j+1 i+1]);
	%ç”Ÿæˆå¯†é’¥æµæ•°ç»„
	K = s(mod(s(i+1) + s(j+1),256) + 1);
	key = [key, K];  
end
end</code></pre>
								<p>åŠ å¯†å¾ˆç®€å•ï¼Œå°±æŠŠå¯†é’¥æµå’Œæ˜æ–‡å¼‚æˆ–ä¸€ä¸‹å°±å¥½äº†ã€‚ä¸Šä»£ç </p>
								<pre><code class="html">%åŠ å¯†ç®—æ³•
function [hex,unicode]=rc4_encode(plaintext,key)
%å¯†é’¥æµ
Z = uint16(prga(ksa(key), length(plaintext)));
P = uint16(char(plaintext));
%å¼‚æˆ–
res = bitxor(Z, P);
%dec2hexç”Ÿæˆä¸€ä¸ªè‡³å°‘ 2 ä½çš„åå…­è¿›åˆ¶
%mat2strå°†çŸ©é˜µè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä¾¿äºè¾“å‡º
hex = mat2str(dec2hex(res,2));
unicode = char(res);
end</code></pre>
								<p>è§£å¯†åŒæ ·å¾ˆç®€å•ï¼Œå°±æŠŠå¯†é’¥æµå’Œå¯†æ–‡å¼‚æˆ–ä¸€ä¸‹å°±è§£å¯†å®Œæˆï¼ä¾ç„¶ä¸Šä»£ç </p>
								<pre><code class="html">%è§£å¯†ç®—æ³•
function decode=rc4_decode(ciphertext,key)
%å¯†é’¥æµ
Z = uint16(prga(ksa(key), length(ciphertext)));
C = uint16(char(ciphertext));
%å¼‚æˆ–
res = bitxor(Z, C);
decode = char(res);
end</code></pre>
								<p>æœ€åä¸»å‡½æ•°è°ƒç”¨ä¸€ä¸‹å°±okäº†ï¼Œå°±æ˜¯é‚£ä¹ˆç®€å•ï¼Matlabæ˜æ˜è¿™ä¹ˆå¥½ç”¨ï¼Œä¸ºä»€ä¹ˆä¸è®©æˆ‘ç”¨ï¼ç”Ÿæ°”ğŸ˜ ï¼<br /></p>
								<p>åŠ è§£å¯†åˆ†å¼€ä»€ä¹ˆçš„æˆ‘å°±æ‡’å¾—æäº†</p>
								<pre><code class="html">%ä¸»å‡½æ•°
clear;clc;
plaintext = 'This is RC4';
key = 'cryptography';
if (length(key) > 256)
	key = key(1:256);
end
[hex,unicode] = rc4_encode(plaintext,key);
disp(['åå…­è¿›åˆ¶åŠ å¯†ç»“æœï¼š',hex newline 'å­—ç¬¦ä¸²åŠ å¯†ç»“æœï¼š',unicode]);
decode = rc4_decode(unicode,key);
disp([newline 'è§£å¯†ç»“æœï¼š',decode]);</code></pre>
								<p>æœ€åçš„å®éªŒç»“æœé•¿è¿™æ ·ï¼š</p>
								<a class="image main"><img src="images/story19927/res.png" alt="" /></a>
								<p>è®¡åˆ’ä¸­çš„ç¬¬äºŒä¸ªåšå®¢ç»“æœæœ€æ—©å†™å®Œï¼Œå› ä¸ºæ•°å­¦å»ºæ¨¡é‚£ä¸ªä¸€ç›´ææµ…ï¼Œå› ä¸ºå®åœ¨ä¸æƒ³å›å¿†å§ã€‚</p>
							</section>

					</div>

					<!-- Footer -->
						<footer id="footer">
							
							<section class="split contact">
								<section class="alt">
									<h3>Address</h3>
									<p>Hangzhou Dianzi University</p>
								</section>
								<section>
									<h3>QQ</h3>
									<p>1114832836</p>
								</section>
								<section>
									<h3>Email</h3>
									<p>17272104@hdu.edu.cn</p>
								</section>
								<section>
									<h3>Social</h3>
									<ul class="icons alt">
										<li><a href="https://www.instagram.com/xuuuyp/" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
										<li><a href="https://github.com/xuuuyp" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
									</ul>
								</section>
							</section>
						</footer>

					<!-- Copyright -->
						<div id="copyright">
							<ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
						</div>

				</div>
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<link rel="stylesheet" href="/path/to/styles/default.css">
			<script src="/path/to/highlight.pack.js"></script>
			<script>hljs.initHighlightingOnLoad();</script>

	</body>
</html>